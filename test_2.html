<!DOCTYPE html>

<html class="dark" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Döviz Takibi Dashboard</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;700;800&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#258cf4",
                        "background-light": "#f5f7f8",
                        "background-dark": "#101922",
                        "surface-dark": "#1a232e", // Slightly lighter for cards
                    },
                    fontFamily: {
                        "display": ["Manrope", "sans-serif"]
                    },
                    borderRadius: { "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "2xl": "1rem", "full": "9999px" },
                },
            },
        }
    </script>
    <style>
        /* Custom glow for chart lines */
        .glow-blue {
            filter: drop-shadow(0 0 4px rgba(37, 140, 244, 0.5));
        }

        .glow-green {
            filter: drop-shadow(0 0 4px rgba(11, 218, 91, 0.5));
        }

        .chart-grid line {
            stroke: rgba(255, 255, 255, 0.05);
        }
    </style>
    <style>
        body {
            min-height: max(884px, 100dvh);
        }
    </style>
</head>

<body
    class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-white font-display overflow-x-hidden min-h-screen flex flex-col">
    <!-- AppHeader -->
    <header class="flex flex-col px-6 pt-8 pb-4">
        <div class="flex items-center justify-between mb-4">
            <div
                class="flex size-10 items-center justify-center rounded-full bg-surface-dark/50 hover:bg-surface-dark transition-colors cursor-pointer">
                <span class="material-symbols-outlined text-white/80">menu</span>
            </div>
            <div
                class="flex size-10 items-center justify-center rounded-full bg-surface-dark/50 hover:bg-surface-dark transition-colors cursor-pointer">
                <span class="material-symbols-outlined text-white/80">notifications</span>
            </div>
        </div>
        <h1 class="text-white tracking-tight text-3xl font-extrabold leading-tight">Döviz Takibi</h1>
        <h2 class="text-slate-400 text-base font-medium mt-1">TRY / USD Zaman Serisi</h2>
    </header>
    <!-- DateRangeIndicator -->
    <div class="px-6 py-2">
        <div class="flex items-center justify-center">
            <div
                class="flex h-9 items-center justify-center gap-x-2 rounded-full bg-surface-dark border border-white/5 pl-4 pr-4 shadow-sm">
                <span class="material-symbols-outlined text-slate-400 text-[18px]">calendar_today</span>
                <p class="text-slate-300 text-sm font-medium leading-normal">14 Oct 2025 – 16 Jan 2026</p>
            </div>
        </div>
    </div>
    <!-- ExchangeRateLineChart -->
    <section class="flex-1 px-4 py-6 w-full max-w-lg mx-auto">
        <div
            class="relative w-full bg-gradient-to-b from-surface-dark/50 to-transparent rounded-2xl p-4 border border-white/5 shadow-xl">
            <!-- Chart Header Info -->
            <div class="flex justify-between items-start mb-6 px-2">
                <div>
                    <p class="text-slate-400 text-xs font-semibold uppercase tracking-wider">Live Market</p>
                    <div class="flex items-center gap-2 mt-1">
                        <span class="size-2 rounded-full bg-primary animate-pulse"></span>
                        <span class="text-primary text-sm font-bold">Market Open</span>
                    </div>
                </div>
                <div class="flex gap-2">
                    <span
                        class="flex items-center gap-1 text-[10px] font-bold text-primary bg-primary/10 px-2 py-1 rounded">
                        TRY
                    </span>
                    <span
                        class="flex items-center gap-1 text-[10px] font-bold text-[#0bda5b] bg-[#0bda5b]/10 px-2 py-1 rounded">
                        USD
                    </span>
                </div>
            </div>
            <!-- SVG Chart -->
            <div class="relative w-full aspect-[4/3] min-h-[220px]">
                <svg class="overflow-visible" fill="none" height="100%" preserveaspectratio="none" viewbox="0 0 400 200"
                    width="100%" xmlns="http://www.w3.org/2000/svg">
                    <!-- Grid Lines -->
                    <g class="chart-grid">
                        <line stroke-dasharray="4 4" stroke-width="1" x1="0" x2="400" y1="40" y2="40"></line>
                        <line stroke-dasharray="4 4" stroke-width="1" x1="0" x2="400" y1="80" y2="80"></line>
                        <line stroke-dasharray="4 4" stroke-width="1" x1="0" x2="400" y1="120" y2="120"></line>
                        <line stroke-dasharray="4 4" stroke-width="1" x1="0" x2="400" y1="160" y2="160"></line>
                    </g>
                    <!-- Definitions for Gradients -->
                    <defs>
                        <lineargradient id="gradBlue" x1="0" x2="0" y1="0" y2="1">
                            <stop offset="0%" stop-color="#258cf4" stop-opacity="0.3"></stop>
                            <stop offset="100%" stop-color="#258cf4" stop-opacity="0"></stop>
                        </lineargradient>
                        <lineargradient id="gradGreen" x1="0" x2="0" y1="0" y2="1">
                            <stop offset="0%" stop-color="#0bda5b" stop-opacity="0.3"></stop>
                            <stop offset="100%" stop-color="#0bda5b" stop-opacity="0"></stop>
                        </lineargradient>
                    </defs>
                    <!-- USD Line (Green) - Bottom Layer -->
                    <path
                        d="M0 160 C 40 155, 80 140, 120 145 C 160 150, 200 130, 240 135 C 280 140, 320 120, 360 125 L 400 120 V 200 H 0 Z"
                        fill="url(#gradGreen)" stroke="none"></path>
                    <path class="glow-green"
                        d="M0 160 C 40 155, 80 140, 120 145 C 160 150, 200 130, 240 135 C 280 140, 320 120, 360 125 L 400 120"
                        fill="none" stroke="#0bda5b" stroke-linecap="round" stroke-linejoin="round" stroke-width="3">
                    </path>
                    <!-- TRY Line (Blue) - Top Layer -->
                    <path
                        d="M0 120 C 50 110, 100 60, 150 70 C 200 80, 250 40, 300 50 C 350 60, 380 30, 400 35 V 200 H 0 Z"
                        fill="url(#gradBlue)" stroke="none"></path>
                    <path class="glow-blue"
                        d="M0 120 C 50 110, 100 60, 150 70 C 200 80, 250 40, 300 50 C 350 60, 380 30, 400 35"
                        fill="none" stroke="#258cf4" stroke-linecap="round" stroke-linejoin="round" stroke-width="3">
                    </path>
                    <!-- Anomalies / Points -->
                    <circle cx="150" cy="70" fill="#111418" r="4" stroke="#258cf4" stroke-width="2"></circle>
                    <circle cx="300" cy="50" fill="#111418" r="4" stroke="#258cf4" stroke-width="2"></circle>
                    <circle class="animate-ping opacity-75" cx="400" cy="35" fill="#258cf4" r="5"></circle>
                    <circle cx="400" cy="35" fill="#258cf4" r="4"></circle>
                </svg>
            </div>
            <!-- X-Axis Labels -->
            <div class="flex justify-between mt-2 px-1 text-[10px] text-slate-500 font-medium">
                <span>Oct</span>
                <span>Nov</span>
                <span>Dec</span>
                <span>Jan</span>
            </div>
        </div>
    </section>
    <!-- LatestValuesRow -->
    <div class="px-6 pb-6">
        <div class="grid grid-cols-2 gap-4">
            <!-- LatestTRYCard -->
            <div
                class="bg-surface-dark rounded-xl p-4 flex flex-col justify-between border border-white/5 relative overflow-hidden group">
                <div class="absolute right-0 top-0 p-3 opacity-10 group-hover:opacity-20 transition-opacity">
                    <span class="material-symbols-outlined text-primary text-5xl">currency_lira</span>
                </div>
                <div class="flex items-center gap-2 mb-2">
                    <div class="bg-primary/20 p-1.5 rounded-lg">
                        <span class="material-symbols-outlined text-primary text-sm">trending_up</span>
                    </div>
                    <span class="text-slate-400 text-sm font-semibold">Son TRY</span>
                </div>
                <div class="space-y-1 z-10">
                    <p class="text-white text-2xl font-bold tracking-tight">34.12 ₺</p>
                    <p class="text-[#0bda5b] text-xs font-bold flex items-center">
                        +1.2%
                        <span class="text-slate-500 font-normal ml-1">vs yesterday</span>
                    </p>
                </div>
            </div>
            <!-- LatestUSDCard -->
            <div
                class="bg-surface-dark rounded-xl p-4 flex flex-col justify-between border border-white/5 relative overflow-hidden group">
                <div class="absolute right-0 top-0 p-3 opacity-10 group-hover:opacity-20 transition-opacity">
                    <span class="material-symbols-outlined text-[#0bda5b] text-5xl">attach_money</span>
                </div>
                <div class="flex items-center gap-2 mb-2">
                    <div class="bg-[#0bda5b]/20 p-1.5 rounded-lg">
                        <span class="material-symbols-outlined text-[#0bda5b] text-sm">trending_down</span>
                    </div>
                    <span class="text-slate-400 text-sm font-semibold">Son USD</span>
                </div>
                <div class="space-y-1 z-10">
                    <p class="text-white text-2xl font-bold tracking-tight">1.00 $</p>
                    <p class="text-rose-500 text-xs font-bold flex items-center">
                        -0.05%
                        <span class="text-slate-500 font-normal ml-1">vs yesterday</span>
                    </p>
                </div>
            </div>
        </div>
    </div>
    <!-- DataMetaFooter -->
    <footer class="mt-auto pb-8 pt-2 px-6 text-center">
        <div class="flex flex-col items-center justify-center gap-1 opacity-50">
            <p class="text-slate-500 text-xs font-medium">Data Points: 154</p>
            <p class="text-slate-600 text-[10px]">Last Updated: Just now</p>
        </div>
    </footer>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // 1. Veriyi LocalStorage'dan Çek
        const rawData = localStorage.getItem('day_data_set');
        if (!rawData) {
            console.error("day_data_set bulunamadı. Lütfen veriyi localStorage'a ekleyin.");
            return;
        }

        const data = JSON.parse(rawData);
        if (data.length === 0) return;

        // 2. DOM Elemanlarını Seç
        const tryValueEl = document.querySelector('.card-try p.text-2xl'); // TRY Degeri
        const usdValueEl = document.querySelector('.card-usd p.text-2xl'); // USD Degeri
        const dateRangeEl = document.querySelector('.date-range-pill p, .date-range-container p'); // Tarih aralığı
        const footerInfoEl = document.querySelector('footer div p:first-child'); // Data Points
        
        // Manuel seçim (Eğer sınıflar tam uymuyorsa id eklemek daha sağlıklıdır, ancak mevcut yapıya göre seçiyoruz):
        const latest = data[data.length - 1];
        const first = data[0];

        // 3. Kartları ve Header'ı Güncelle
        const formatDate = (dateStr) => {
            const d = new Date(dateStr);
            return d.toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' });
        };

        // Tarih Aralığı
        const rangeText = document.querySelector('.px-6.py-2 p');
        if(rangeText) rangeText.textContent = `${formatDate(first.date)} – ${formatDate(latest.date)}`;

        // Değerler
        const tryPrice = document.querySelectorAll('.text-2xl.font-bold')[0];
        const usdPrice = document.querySelectorAll('.text-2xl.font-bold')[1];
        if(tryPrice) tryPrice.textContent = `${latest.turkish_lira.toFixed(2)} ₺`;
        if(usdPrice) usdPrice.textContent = `${latest.dolar.toFixed(3)} $`;

        // Footer
        const dataCount = document.querySelector('footer p:first-child');
        if(dataCount) dataCount.textContent = `Data Points: ${data.length}`;

        // 4. Dinamik SVG Grafik Çizimi
        const svgWidth = 400;
        const svgHeight = 200;
        const padding = 20;

        const getPath = (key, color) => {
            const values = data.map(d => d[key]);
            const min = Math.min(...values);
            const max = Math.max(...values);
            const range = max - min;

            const points = data.map((d, i) => {
                const x = (i / (data.length - 1)) * svgWidth;
                // Değeri normalize et ve ters çevir (SVG'de 0 üsttedir)
                const y = svgHeight - padding - ((d[key] - min) / range) * (svgHeight - 2 * padding);
                return `${x},${y}`;
            });

            return points.join(' L ');
        };

        // Mevcut statik pathleri güncelle
        const tryPath = document.querySelector('.glow-blue');
        const tryFill = document.querySelector('path[fill="url(#gradBlue)"]');
        const usdPath = document.querySelector('.glow-green');
        const usdFill = document.querySelector('path[fill="url(#gradGreen)"]');

        const tryDataPath = `M ${getPath('turkish_lira')}`;
        const usdDataPath = `M ${getPath('dolar')}`;

        if(tryPath) tryPath.setAttribute('d', tryDataPath);
        if(tryFill) tryFill.setAttribute('d', `${tryDataPath} L ${svgWidth},${svgHeight} L 0,${svgHeight} Z`);
        
        if(usdPath) usdPath.setAttribute('d', usdDataPath);
        if(usdFill) usdFill.setAttribute('d', `${usdDataPath} L ${svgWidth},${svgHeight} L 0,${svgHeight} Z`);

        // Son nokta (Anomalies/Points kısmındaki pulse efekti)
        const lastPointX = svgWidth;
        const lastPointY_TRY = svgHeight - padding - ((latest.turkish_lira - Math.min(...data.map(d => d.turkish_lira))) / (Math.max(...data.map(d => d.turkish_lira)) - Math.min(...data.map(d => d.turkish_lira)))) * (svgHeight - 2 * padding);
        
        const pulseCircles = document.querySelectorAll('circle[cx="400"]');
        pulseCircles.forEach(c => {
            c.setAttribute('cy', lastPointY_TRY);
        });
    });
</script>

</body>

</html>